(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[933],{11654:function(e,t,n){Promise.resolve().then(n.bind(n,51073))},51073:function(e,t,n){"use strict";let s,a,r,o,l,i,c,u,d,m,h,f,w,g;n.r(t),n.d(t,{default:function(){return _}});var x=n(57437),p=n(32201),v=n(48586),b=n(70095),j=n(36002),y=n(2265);function V(e){let{onButtonChange:t}=e,[n,s]=(0,y.useState)(null),a=e=>{if(n==e){console.log("You alreade clicked button");return}s(e),t(e),localStorage.setItem("status",e)};(0,y.useEffect)(()=>{s(localStorage.getItem("status"))},[]);let r=e=>{let t="text-white bg-amber-600 hover:bg-amber-700 border-slate-900 font-medium text-sm px-5 py-2 text-center mb-2";return e===n&&(t+=" bg-amber-700"),t};return(0,x.jsxs)("div",{children:[(0,x.jsx)("button",{type:"button",className:"border-orange-900 font-medium border-2 rounded-l-xl ".concat(r("All")),onClick:()=>a("All"),children:"All"}),(0,x.jsx)("button",{type:"button",className:"border-orange-900 font-medium border-y-2 ".concat(r("Listed")),onClick:()=>a("Listed"),children:"Listed"}),(0,x.jsx)("button",{type:"button",className:"border-orange-900 font-medium border-2 rounded-r-xl ".concat(r("Bought")),onClick:()=>a("Bought"),children:"Bought"})]})}var N=n(53159),k=n(13087),C=n(83007);function I(){let[e,t]=(0,y.useState)();async function n(){try{let e=await r.methods.getAmountEarned(a[0]).call({from:a[0]});t(s.utils.fromWei(e,"ether"))}catch(e){console.error(e)}}n();let o=async()=>{await r.methods.withdrawFunds().send({from:a[0]}).then(()=>{n()})};return(0,x.jsxs)("div",{className:"flex",children:[(0,x.jsxs)("div",{className:"flex justify-center items-center mr-3",children:[(0,x.jsxs)("p",{className:"text-transparent text-lg bg-clip-text bg-gradient-to-r from-zinc-800 to-neutral-800 font-semibold",children:["Your Balance ",(0,x.jsx)("span",{className:"text-transparent text-slate-950 font-bold",children:e})]}),(0,x.jsx)(N.$$w,{})]}),(0,x.jsx)("button",{type:"button",className:"inline-block rounded-xl bg-gradient-to-r from-cyan-600 via-teal-600 to-sky-700 px-6 py-2 text-xs font-medium uppercase leading-normal text-gray-200 shadow-md transition duration-150 ease-in-out hover:from-cyan-700 hover:via-teal-700 hover:to-sky-800 hover:shadow-lg focus:bg-blue-600 focus:shadow-lg focus:outline-none focus:ring focus:ring-blue-200 active:bg-blue-700 dark:shadow-lg",onClick:o,children:"Withdraw"})]})}async function A(){void 0!==window.ethereum&&await Promise.resolve(o=new k.ZPm(window.ethereum),await o.eth.getAccounts(),l=new o.eth.Contract(C.MS,C.IR))}async function B(e){await A();let t=await l.getPastEvents("ItemListed",{filter:{owner:e},fromBlock:0,toBlock:"latest"}),n=await l.getPastEvents("ItemBought",{fromBlock:0,toBlock:"latest"}),s=await l.getPastEvents("ItemCanceled",{fromBlock:0,toBlock:"latest"});return n.forEach(e=>{t=t.filter(t=>!(t.returnValues.nftAddress==e.returnValues.nftAddress&&t.returnValues.tokenId==e.returnValues.tokenId&&t.returnValues.owner!==e.returnValues.newOwner&&t.returnValues.timestamp<e.returnValues.timestamp))}),s.forEach(e=>{t=t.filter(t=>(console.log(t.returnValues,e.returnValues),!(t.returnValues.nftAddress==e.returnValues.nftAddress&&t.returnValues.tokenId==e.returnValues.tokenId&&t.returnValues.owner==e.returnValues.owner&&t.returnValues.timestamp<e.returnValues.timestamp)))}),await Promise.all(t.map(async e=>{i=new o.eth.Contract(C.n1,e.returnValues.nftAddress);let t="https://ipfs.io/ipfs/"+(await i.methods.TOKEN_URI().call()).replace("ipfs://",""),n=await (await fetch(t)).json();e.returnValues.image=n.image,e.returnValues.name=n.name,e.returnValues.description=n.description,e.returnValues.type="L"})),t}async function P(){void 0!==window.ethereum&&await Promise.resolve(c=new k.ZPm(window.ethereum),await c.eth.getAccounts(),u=new c.eth.Contract(C.MS,C.IR))}async function S(e){await P();let t=await u.getPastEvents("ItemBought",{filter:{newOwner:e},fromBlock:0,toBlock:"latest"});return await Promise.all(t.map(async e=>{d=new c.eth.Contract(C.n1,e.returnValues.nftAddress);let t="https://ipfs.io/ipfs/"+(await d.methods.TOKEN_URI().call()).replace("ipfs://",""),n=await (await fetch(t)).json();e.returnValues.image=n.image,e.returnValues.name=n.name,e.returnValues.description=n.description,e.returnValues.type="B"})),0!==t.lenght||console.log("Dont have items"),t}async function E(){void 0!==window.ethereum&&await Promise.resolve(m=new k.ZPm(window.ethereum),await m.eth.getAccounts(),new m.eth.Contract(C.MS,C.IR))}async function Z(e){await E();let t=await S(e),n=(await B(e)).concat(t);return await Promise.all(n.map(async e=>{h=new m.eth.Contract(C.n1,e.returnValues.nftAddress);let t="https://ipfs.io/ipfs/"+(await h.methods.TOKEN_URI().call()).replace("ipfs://",""),n=await (await fetch(t)).json();e.returnValues.image=n.image,e.returnValues.name=n.name,e.returnValues.description=n.description})),0!==n.lenght||console.log("Dont have items"),n}!async function(){void 0!==window.ethereum&&await Promise.resolve(s=new k.ZPm(window.ethereum),a=await s.eth.getAccounts(),r=new s.eth.Contract(C.MS,C.IR))}();var F=n(58628),R=n(51056);function _(){let[e,t]=(0,y.useState)([]),[n,s]=(0,y.useState)(),[a,r]=(0,y.useState)(),[o,l]=(0,y.useState)(),[i,c]=(0,y.useState)(!1),u=(0,R.mA)();async function d(e,n){await g.methods.cancelListing(e,n).send({from:w[0]}).then(()=>{t(t=>t.filter(t=>!(t.returnValues.nftAddress==e&&t.returnValues.tokenId==n))),c(!0)})}let m=e=>{let n=localStorage.getItem("status");"All"==n?Z(e).then(e=>{r(!0),t(e),console.log(e)}):"Listed"==n?B(e).then(e=>{r(!0),t(e)}):"Bought"==n&&S(e).then(e=>{r(!0),t(e)})};return(0,y.useEffect)(()=>{"connected"==u.status?(l("You haven't picked your NFTs yet."),m(u.address),window.ethereum.on("accountsChanged",e=>{m(e[0])})):"disconnected"==u.status&&(r(!1),l("Please connect your Wallet"))},[n,u.status]),(0,x.jsx)(b.default,{children:(0,x.jsxs)("div",{className:"min-h-screen bg-gradient-to-r from-purple-700 via-pink-600 to-indigo-800 flex flex-col relative overflow-hidden",children:[(0,x.jsx)(v.default,{}),(0,x.jsx)("link",{href:"https://cdn.jsdelivr.net/npm/tailwindcss@2.2.15/dist/tailwind.min.css",rel:"stylesheet"}),(0,x.jsx)("div",{className:"min-h-screen flex flex-col relative overflow-hidden",children:(0,x.jsxs)("div",{className:"min-h-screen flex flex-col relative overflow-hidden",children:[(0,x.jsxs)("div",{className:"flex justify-between",children:[(0,x.jsx)("div",{className:"m-4",children:(0,x.jsx)(I,{})}),(0,x.jsx)("div",{className:"m-4",children:(0,x.jsx)(V,{onButtonChange:e=>{s(e)}})})]}),(0,x.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 m-2",children:a?0!=e.length?e.map(e=>(0,x.jsx)(j.Z,{name:e.returnValues.name,seller:e.returnValues.owner||e.returnValues.newOwner,description:e.returnValues.description,price:f.utils.fromWei(e.returnValues.price,"ether"),image:e.returnValues.image,isYour:!0,isBought:"L"!=e.returnValues.type,ButtonName:"Cancel Listing",childFunction:()=>d(e.returnValues.nftAddress,e.returnValues.tokenId),_nftaddress:e.returnValues.nftAddress,_tokenId:e.returnValues.tokenId})):(0,x.jsx)("div",{className:"flex items-center justify-center col-span-4",children:(0,x.jsxs)("p",{className:"text-xl text-transparent bg-clip-text font-semibold bg-gradient-to-r from-stone-700 via-stone-800 to-stone-900",children:["You don't have ","All"==n?"":n," Items yet."]})}):(0,x.jsx)("div",{className:"flex h-60 items-center justify-center col-span-4",children:(0,x.jsx)("div",{className:"text-2xl text-transparent bg-clip-text font-semibold bg-gradient-to-r from-slate-800 via-slate-900 to-slate-950",children:(0,x.jsx)("p",{children:o})})})}),(0,x.jsx)(F.Z,{message:"NFT is Canceled",anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:6e3,onClose:()=>c(!1),open:i})]})}),(0,x.jsx)(p.Z,{})]})})}!async function(){f=new k.ZPm(void 0!==window.ethereum?window.ethereum:"wss://eth-goerli.g.alchemy.com/v2/ZRVf6BagEk3VCqFlj7OKlq_jZUznQsGD"),w=await f.eth.getAccounts(),g=new f.eth.Contract(C.MS,C.IR)}()},36002:function(e,t,n){"use strict";let s,a,r;n.d(t,{Z:function(){return g}});var o=n(57437),l=n(13087),i=n(2265),c=n(16691),u=n.n(c),d=n(83007),m=n(68313),h=n(51056),f=n(24033);async function w(){s=new l.ZPm(void 0!==window.ethereum?window.ethereum:"wss://eth-goerli.g.alchemy.com/v2/ZRVf6BagEk3VCqFlj7OKlq_jZUznQsGD"),a=await s.eth.getAccounts(),r=new s.eth.Contract(d.MS,d.IR)}function g(e){let{name:t,seller:n,description:l,price:c,image:d,childFunction:g,_nftaddress:x,_tokenId:p,ButtonName:v,isBought:b=!1,isYour:j=!1}=e,y=(0,h.mA)(),V=(0,f.useRouter)(),N="".concat(n.slice(0,7),"...").concat(n.slice(-5)),[k,C]=(0,i.useState)(N),[I,A]=(0,i.useState)();(0,i.useEffect)(()=>{w(),"connected"==y.status&&(n==a[0]&&C("You"),window.ethereum.on("accountsChanged",e=>{n.toLowerCase()==e[0]?C("You"):C(N)})),"disconnected"==y.status&&C(N);let e=async()=>{let e=await r.methods.getLatestPriceInUSD(x,p,m.networkConfig[5].ethUsdPriceFeed).call();A(parseFloat(s.utils.fromWei(e,"ether")).toFixed(2))};e();let t=setInterval(e,36e5);return()=>clearInterval(t)},[y.status,c]);let B=()=>{let e=new URLSearchParams({name:t,seller:n,description:l,price:c,image:d,_nftaddress:x,_tokenId:p}).toString();V.push("http://localhost:3000/nft-info?".concat(e))};return(0,o.jsx)("div",{className:"transition-transform duration-300 hover:scale-105",children:(0,o.jsxs)("div",{className:"bg-gradient-to-r from-pink-900 to-purple-950 flex rounded-xl border-2 border-gray-900 justify-start items-start p-0.5 mx-9 mb-6 relative",children:[(0,o.jsxs)("div",{className:"flex flex-col justify-start items-start",onClick:B,children:[(0,o.jsx)(u(),{loader:()=>d,src:d,alt:"Nft Image",width:"325",height:"300",className:"rounded-lg border-2 border-slate-900"}),(0,o.jsxs)("div",{className:"flex flex-col justify-start items-start m-2",children:[(0,o.jsx)("p",{className:"text-left text-white text-lg",children:t}),(0,o.jsxs)("p",{className:"text-left text-white text-lg",children:["Owner: ",j?"You":k]}),b?(0,o.jsx)("p",{className:"italic text-lg text-transparent bg-clip-text bg-gradient-to-r from-zinc-800 via-gray-800 to-slate-900",children:"You Bought this NFT"}):(0,o.jsxs)("div",{className:"text-left text-white",children:[(0,o.jsx)("p",{className:"text-sm",children:"Current price"}),(0,o.jsxs)("p",{className:"text-sm",children:[c," ETH ($",I,")"]})]})]})]}),!b&&(0,o.jsx)("div",{className:"absolute bottom-2.5 right-2.5",children:(0,o.jsx)("button",{onClick:g||B,className:"bg-pink-500 hover:bg-pink-600 text-white font-bold py-1.5 px-3 rounded-xl",children:v})})]})})}w()},70095:function(e,t,n){"use strict";n.r(t);var s=n(57437),a=n(2265);t.default=e=>{let{children:t}=e,[n,r]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=setTimeout(()=>r(!1),400);return()=>clearTimeout(e)},[]),(0,s.jsx)("div",{className:"bg-gradient-to-r from-purple-400 via-purple-600 to-indigo-700",children:(0,s.jsx)("div",{className:"transition-all ease-in-out duration-300 ".concat(n?"opacity-0":"opacity-100"),children:t})})}},68313:function(e){e.exports={networkConfig:{31337:{name:"localhost"},5:{name:"goerli",ethUsdPriceFeed:"0xD4a33860578De61DBAbDc8BFdb98FD742fA7028e"}},developmentChains:["hardhat","localhost"]}}},function(e){e.O(0,[582,420,983,389,176,758,628,7,134,971,938,744],function(){return e(e.s=11654)}),_N_E=e.O()}]);